# Vercel Deployment Guide

## ‚úÖ Pre-Deployment Checklist

Your project is now ready for Vercel deployment! Here's what you need to do:

## üöÄ Step 1: Push Latest Changes

```bash
git add -A
git commit -m "chore: Configure for Vercel deployment with Prisma support"
git push
```

## üîß Step 2: Vercel Project Settings

### Build & Development Settings:
- **Framework Preset**: Next.js
- **Build Command**: `npm install --legacy-peer-deps && npx prisma generate && npm run build`
- **Output Directory**: `.next` (default)
- **Install Command**: `npm install --legacy-peer-deps`
- **Node Version**: 18.x or higher

## üîê Step 3: Environment Variables

Add these in Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables:

### Required Variables:

```bash
# Azure OpenAI (REQUIRED - for AI generation)
AZURE_OPENAI_KEY=your_azure_openai_key_here
AZURE_OPENAI_ENDPOINT=https://your-resource.cognitiveservices.azure.com
AZURE_OPENAI_DEPLOYMENT=gpt-4o
AZURE_OPENAI_API_VERSION=2025-01-01-preview

# Azure Computer Vision (REQUIRED - for image analysis)
AZURE_VISION_KEY=your_azure_vision_key_here
AZURE_VISION_ENDPOINT=https://your-vision-resource.cognitiveservices.azure.com/

# Azure Speech Service (OPTIONAL - for voice input)
AZURE_SPEECH_KEY=your_azure_speech_key_here
AZURE_SPEECH_REGION=centralindia

# Clerk Authentication (REQUIRED)
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=your_clerk_publishable_key
CLERK_SECRET_KEY=your_clerk_secret_key
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_REDIRECT_URL=/dashboard
NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_REDIRECT_URL=/dashboard

# Supabase Database (REQUIRED)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key

# Database Connection (REQUIRED - IMPORTANT!)
DATABASE_URL=postgresql://user:password@host:5432/postgres?pgbouncer=true&connection_limit=1
DIRECT_URL=postgresql://user:password@host:5432/postgres

# App URL (will be auto-generated by Vercel, but you can set custom domain later)
NEXT_PUBLIC_APP_URL=https://your-app.vercel.app
```

**‚ö†Ô∏è IMPORTANT: Use YOUR actual values from .env.local file! These are just placeholders.**

### Important Notes:

1. **DATABASE_URL must include `?pgbouncer=true&connection_limit=1`** for Vercel serverless functions
2. **NEXT_PUBLIC_APP_URL** - After first deployment, update this with your actual Vercel URL
3. All variables starting with `NEXT_PUBLIC_` are exposed to the browser
4. Apply environment variables to: **Production, Preview, and Development**

## üìù Step 4: Deploy

### Option A: Deploy via GitHub Integration (Recommended)
1. Go to [vercel.com/new](https://vercel.com/new)
2. Import your GitHub repository: `SHARJIDH/cad-dev`
3. Vercel will auto-detect Next.js
4. Add all environment variables (from Step 3)
5. Click **Deploy**

### Option B: Deploy via CLI
```bash
npm i -g vercel
vercel login
vercel --prod
```

## üîÑ Step 5: Post-Deployment

After successful deployment:

1. **Update AR QR Codes**: 
   - Replace `NEXT_PUBLIC_APP_URL` in Vercel environment variables
   - Use your production URL: `https://your-app.vercel.app`
   - Redeploy to apply changes

2. **Update Clerk URLs**:
   - Go to Clerk Dashboard
   - Add your Vercel domain to allowed origins
   - Update redirect URLs if using custom domain

3. **Test Features**:
   - ‚úÖ Sign in/Sign up
   - ‚úÖ CAD generation
   - ‚úÖ Photo upload & analysis
   - ‚úÖ Voice input
   - ‚úÖ AR QR code generation
   - ‚úÖ Interior Designer
   - ‚úÖ Export functionality

## ‚ö†Ô∏è Common Issues & Solutions

### Issue 1: Build fails with Prisma error
**Solution**: Make sure `postinstall` script is in package.json:
```json
"postinstall": "prisma generate"
```

### Issue 2: Database connection timeout
**Solution**: Ensure DATABASE_URL has `?pgbouncer=true&connection_limit=1`

### Issue 3: API routes timeout (500 error)
**Solution**: Functions are configured for 60s max duration (already set in vercel.json)

### Issue 4: Environment variables not working
**Solution**: 
- Check spelling (case-sensitive!)
- Make sure they're applied to all environments
- Redeploy after adding new variables

### Issue 5: Images not loading
**Solution**: Next.js image optimization is disabled (already configured in next.config.mjs)

## üéØ Performance Tips

1. **Enable Vercel Analytics** (free tier available)
2. **Add custom domain** for professional look
3. **Enable Preview Deployments** for testing
4. **Set up monitoring** with Vercel's built-in tools

## üèÜ Hackathon Demo Tips

1. Share your Vercel deployment link
2. Use preview deployments for different features
3. Show real-time updates with Git pushes
4. Vercel Analytics can show usage metrics during presentation

## üìû Support

If deployment fails, check:
1. Vercel deployment logs (detailed error messages)
2. GitHub Actions logs
3. Browser console for client-side errors
4. API route responses in Network tab

---

**Your app includes:**
- ‚úÖ AI-powered CAD generation
- ‚úÖ Photo-to-3D conversion
- ‚úÖ Voice input with speech recognition
- ‚úÖ AR model viewing
- ‚úÖ Interior design suggestions
- ‚úÖ Real-time collaboration
- ‚úÖ Export in multiple formats

**Tech Stack:**
- Next.js 15.2.3
- Azure OpenAI (GPT-4)
- Azure Computer Vision
- Prisma + Supabase PostgreSQL
- Clerk Authentication
- Three.js for 3D rendering

Good luck with your hackathon! üöÄ
